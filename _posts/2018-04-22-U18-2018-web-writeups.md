---
layout: post
category : information-security
cover: https://user-images.githubusercontent.com/14227502/39092045-d4ced81e-4635-11e8-82b9-edf6523c4c32.png
color: "#fff"
tags : [haruul-zangi, u18]
---

Өдрийн мэнд. Энэ жилийн U18-д ирсэн зарим вэбийн даалгавруудын **writeup**-уудыг хүргэж байна.
ХаруулЗангиас тухайн шат дууссаны дараа вэб серверүүдээ шууд унтраадаг учраас тэдгээр даалгавруудыг л
хийлээ, бусад даалгавруудыг өөрсдөө [энд](https://github.com/enkhee-Osiris/u18-2018)ээс хийж үзээрэй. 

## Logmein1 бие халаалт (5pts)

**Хандах хаяг:** http://218.100.84.112:9000  
**Оноо:** 5 оноо  
**Зохиосон:** reamb 

---

Өгөгдсөн вэб хуудсыг доорх зурагт үзүүлэв.

<img width="843" alt="screenshot" src="https://user-images.githubusercontent.com/14227502/39092057-203f6f3e-4636-11e8-8bb2-267195bb8004.png">

Уг даалгаварт өгөгдсөн хуудасны **source**-г харвал дараах жаваскрипт байв.

{% gist ea938b473e41b4ab9fc4ea82d4bef448 %}

> username болон password-г зөв оруулбал  
> success.php хуудас руу үсэрч байна.  
> Уг хуудас руу орвол туг харагдана.

```
Here is your flag: HZU18{cl1ent_s1d3_auth_sux}
```

## Logmein2 (10pts)

**Хандах хаяг:** http://218.100.84.112:9003  
**Оноо:** 10 оноо  
**Зохиосон:** reamb 

---

Өгөгдсөн вэб хуудас өмнөх даалгавартай яг адилхан харагдав.  
Уг даалгаварт өгөгдсөн хуудасны **source**-г харвал дараах коммэнт байв.  
**<!-- delete it later index.phps --!>**  
Орж үзэхэд дараах **php** код харагдана.

{% gist 52583507a663a3cb72c23fea954cbcfb %}

Өгөгдсөн `86a8b9ded31796c99d3cd6336609bc88` **md5** хашыг [энд](http://md5decrypt.net/en/)-ээс хайвал 
`SuperSecurePassword` гэж олдоно.

> Олдсон username => admin  
> password => SuperSecurePassword-аар нэвтрэхэд туг харагдах болно.

```
HZU18{you_kn0w_about_hash}
```

## Logmein3 (50pts)

**Хандах хаяг:** http://218.100.84.112:9001  
**Оноо:** 50 оноо  
**Зохиосон:** Ds3c

---

Өгөгдсөн вэб хуудас энгийн л хэрэглэгчийн нэр болон нууц үгийн форм харагдана.  
Мөн **php** эх код харах холбоос байв. Эх кодыг доор харуулав.

{% gist 416e79519911c46cef5167bf62b2e7b8 %}

Уг кодыг анализ хийвэл **username** болон **password** нь өөр боловч md5 хаш нь `==` шалгалтыг давах ёстой харагдана.

> Үүнийг давахын тулд бяцхан заль ашиглах болно.  
> md5 хаш нь `0e123...` тай тэнцүү байх утгуудыг ашиглая.  
> Энэ алдааны талаар [энд](http://turbochaos.blogspot.com/2013/08/exploiting-exotic-bugs-php-type-juggling.html)ээс дэлгэрэнгүй уншаарай.

```
MD5 ("240610708") = 0e462097431906509019562988736854
MD5 ("aabg7XSs") = 0e087386482136013740957780965295
MD5 ("aaroZmOk") = 4e91292830102879cd95e9bae60460e7
MD5 ("QNKCDZO") = 0e830400451993494058024219903391
MD5 ("aabC9RqS") = 0e041022518165728065344349536299
MD5 ("Password147186970!") = 0e153958235710973524115407854157
```

Дээрх жагсаалтаас дурын 2-ыг сонгон нэвтрэхэд туг гарч ирнэ.
```
password Password147186970!
username 240610708
```

```
HZU18{s1gns1gns1gnaftermd5}
```


## Baby Web (65pts)

**Хандах хаяг:** http://218.100.84.112:9004/  
**Оноо:** 65 оноо  
**Зохиосон:** W01f

---

Уг даалгаварт өгөгдсөн шифиг доор оруулав.

{% gist e1924bbb37cb226b1a06ed5640fcceab %}

Уг кодыг анализ хийвэл 999 өөс их тоо оруулах ёстой боловч орон нь 3аас их байж болохгүй.

> Энэ даалгаврыг хийхийн тулд  
> 1000 = 10^3 = 1 * 10^3 = 1e3 бичиглэлийг ашиглах ёстой.

`1e3` гэсэн утгыг формд бөглөхөд туг гарч ирнэ.

```
Flag: HZU18{HEX_NUMBER>999}
```
